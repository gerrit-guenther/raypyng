%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{RayPyNG}
\date{Oct 15, 2022}
\release{}
\author{Simone Vadilonga, Ruslan Ovsyannikov}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
raypyng provides a simple API to work with RAY\sphinxhyphen{}UI, a software for optical simulation of synchrotron beamlines and x\sphinxhyphen{}ray systems developed by Helmholtz\sphinxhyphen{}Zentrum Berlin.

\sphinxstepscope


\chapter{Install}
\label{\detokenize{install_raypyng:install}}\label{\detokenize{install_raypyng::doc}}
\sphinxAtStartPar
raypyng will work only if using a linux or a MacOS distribustion.


\section{Install RAY\sphinxhyphen{}UI}
\label{\detokenize{install_raypyng:install-ray-ui}}
\sphinxAtStartPar
Download the RAY\sphinxhyphen{}UI installer from  \sphinxhref{https://www.helmholtz-berlin.de/forschung/oe/wi/optik-strahlrohre/arbeitsgebiete/ray\_en.html}{this link},
and run the installer.


\section{Install xvfb}
\label{\detokenize{install_raypyng:install-xvfb}}
\sphinxAtStartPar
xvfb is a virtual X11 framebuffer server that let you run RAY\sphinxhyphen{}UI headless
\begin{description}
\sphinxlineitem{Install xvfb:}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
sudo apt install xvfb
\end{sphinxVerbatim}

\end{description}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
xvfb\sphinxhyphen{}run script is a part of the xvfb distribuion and
runs an app on a new virtual X11 server.
\end{sphinxadmonition}


\section{Install raypyng}
\label{\detokenize{install_raypyng:install-raypyng}}\begin{itemize}
\item {} 
\sphinxAtStartPar
You will need Python 3.8 or newer. From a shell (“Terminal” on OSX,
“Command Prompt” on Windows), check your current Python version.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python3 \PYGZhy{}\PYGZhy{}version
\end{sphinxVerbatim}

\sphinxAtStartPar
If that version is less than 3.8, you must update it.

\sphinxAtStartPar
We recommend install bluesky into a “virtual environment” so this
installation will not interfere with any existing Python software:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python3 \PYGZhy{}m venv \PYGZti{}/raypyng\PYGZhy{}tutorial
\PYG{n+nb}{source} \PYGZti{}/raypyng\PYGZhy{}tutorial/bin/activate
\end{sphinxVerbatim}

\sphinxAtStartPar
Alternatively, if you are a
\sphinxhref{https://conda.io/docs/user-guide/install/download.html}{conda} user,
you can create a conda environment:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
conda create \PYGZhy{}n raypyng\PYGZhy{}tutorial \PYG{l+s+s2}{\PYGZdq{}python\PYGZgt{}=3.8\PYGZdq{}}
conda activate raypyng\PYGZhy{}tutorial
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Install the latest versions of raypyng and ophyd. Also install IPython
(a Python interpreter designed by scientists for scientists).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python3 \PYGZhy{}m pip install \PYGZhy{}\PYGZhy{}upgrade raypyng ipython
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Start IPython:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ipython} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{matplotlib}\PYG{o}{=}\PYG{n}{qt5}
\end{sphinxVerbatim}

\sphinxAtStartPar
The flag \sphinxcode{\sphinxupquote{\sphinxhyphen{}\sphinxhyphen{}matplotlib=qt5}} is necessary for live\sphinxhyphen{}updating plots to work.

\sphinxAtStartPar
Or, if you wish you use raypyng from a Jupyter notebook, install a kernel like
so:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ipython} \PYG{n}{kernel} \PYG{n}{install} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{user} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{name}\PYG{o}{=}\PYG{n}{raypyng}\PYG{o}{\PYGZhy{}}\PYG{n}{tutorial} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{display}\PYG{o}{\PYGZhy{}}\PYG{n}{name} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Python (raypyng)}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
You may start Jupyter from any environment where it is already installed, or
install it in this environment alongside raypyng and run it from there:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{notebook}
\PYG{n}{jupyter} \PYG{n}{notebook}
\end{sphinxVerbatim}

\end{itemize}

\sphinxstepscope


\chapter{Tutorial}
\label{\detokenize{tutorial:tutorial}}\label{\detokenize{tutorial::doc}}

\section{Minimal example}
\label{\detokenize{tutorial:minimal-example}}
\sphinxAtStartPar
raypyng is not able to create a beamline from scratch. To do so, use RAY\sphinxhyphen{}UI,
create a beamline, and save it. What you save is \sphinxtitleref{.rml} file, that you have to
pass as an argumet to the \sphinxtitleref{Simulate} simulate class. In the following example we
use the file for a beamline called \sphinxtitleref{elisa}, and the file is saved in \sphinxtitleref{rml/elisa.rml}.
The \sphinxtitleref{hide} parameter can be set to true only if \sphinxtitleref{xvfb} is installed.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{raypyng} \PYG{k+kn}{import} \PYG{n}{Simulate}
\PYG{n}{rml\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{sim} \PYG{o}{=} \PYG{n}{Simulate}\PYG{p}{(}\PYG{n}{rml\PYGZus{}file}\PYG{p}{,} \PYG{n}{hide}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{elisa} \PYG{o}{=} \PYG{n}{sim}\PYG{o}{.}\PYG{n}{rml}\PYG{o}{.}\PYG{n}{beamline}
\end{sphinxVerbatim}

\sphinxAtStartPar
The elements of the beamline are now available as python objects, as well as
their properties. If working in ipython, tab autocompletion is available.
For instance to acess the source, a dipole in this case:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} this is the dipole object}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}
\PYG{c+c1}{\PYGZsh{} to acess its parameter, for instance the photonFlux}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonFlux}
\PYG{c+c1}{\PYGZsh{} to acess the value}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonFlux}\PYG{o}{.}\PYG{n}{cdata}
\PYG{c+c1}{\PYGZsh{} to modify the value}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonFlux}\PYG{o}{.}\PYG{n}{cdata} \PYG{o}{=} \PYG{l+m+mi}{10}
\end{sphinxVerbatim}

\sphinxAtStartPar
To perform simulation, any number of parameters can varied.
For instance one can vary the photon energy of the source, and set a
certain aperture of the exit slits:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} define the values of the parameters to scan}
\PYG{n}{energy}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{7201}\PYG{p}{,}\PYG{l+m+mi}{250}\PYG{p}{)}
\PYG{n}{SlitSize}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} define a list of dictionaries with the parameters to scan}
\PYG{n}{params} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{p}{:}\PYG{n}{energy}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{ExitSlit}\PYG{o}{.}\PYG{n}{totalHeight}\PYG{p}{:}\PYG{n}{SlitSize}\PYG{p}{\PYGZcb{}}
        \PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}and then plug them into the Simulation class}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{params}\PYG{o}{=}\PYG{n}{params}
\end{sphinxVerbatim}

\sphinxAtStartPar
It is also possible to define coupled parameters. If for instance one wants
to increase the number of rays with the photon energy

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} define the values of the parameters to scan}
\PYG{n}{energy}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{7201}\PYG{p}{,}\PYG{l+m+mi}{250}\PYG{p}{)}
\PYG{n}{nrays}     \PYG{o}{=} \PYG{n}{energy}\PYG{o}{*}\PYG{l+m+mi}{100}
\PYG{n}{SlitSize}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} define a list of dictionaries with the parameters to scan}
\PYG{n}{params} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{p}{:}\PYG{n}{energy}\PYG{p}{,} \PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{numberRays}\PYG{p}{:}\PYG{n}{nrays}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{ExitSlit}\PYG{o}{.}\PYG{n}{totalHeight}\PYG{p}{:}\PYG{n}{SlitSize}\PYG{p}{\PYGZcb{}}
        \PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}and then plug them into the Simulation class}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{params}\PYG{o}{=}\PYG{n}{params}
\end{sphinxVerbatim}

\sphinxAtStartPar
The simulations files and the results will be saved in a folder called \sphinxtitleref{RAYPy\_simulation\_}
plusa name at your choce, that can be set. This folder will be saved, by default,
in the folder where the program is executed, but it can be eventually be modified

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{simulation\PYGZus{}folder} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/home/raypy/Documents/simulations}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{simulation\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
This will create a simulation folder with the following path and name

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{/}\PYG{n}{home}\PYG{o}{/}\PYG{n}{raypy}\PYG{o}{/}\PYG{n}{Documents}\PYG{o}{/}\PYG{n}{simulations}\PYG{o}{/}\PYG{n}{RAYPy\PYGZus{}simulation\PYGZus{}test}
\end{sphinxVerbatim}

\sphinxAtStartPar
Sometimes, instead of using millions of rays, it is more convenient to repeat the simulations and average the results
The we can set which parameters of which optical elements can be exported. The number of rounds of simulations can be set like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} repeat the simulations as many time as needed}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{repeat} \PYG{o}{=} \PYG{l+m+mi}{1}
\end{sphinxVerbatim}

\sphinxAtStartPar
One can decide weather want RAY\sphinxhyphen{}UI or raypyng to do a prelimanary analysis of the results.
To let RAY\sphinxhyphen{}UI analyze the results, one has to set:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{analyze} \PYG{o}{=} \PYG{k+kc}{True} \PYG{c+c1}{\PYGZsh{} let RAY\PYGZhy{}UI analyze the results}
\end{sphinxVerbatim}

\sphinxAtStartPar
In this case the following exports are available:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{sim}\PYG{o}{.}\PYG{n}{possible\PYGZus{}exports}\PYG{p}{)}
\PYG{o}{\PYGZgt{}} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AnglePhiDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AnglePsiDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BeamPropertiesPlotSnapshot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{EnergyDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintAbsorbedRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintAllRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintOutgoingRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintPlotSnapshot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintWastedRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IntensityPlotSnapshot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IntensityX}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IntensityYZ}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PathlengthDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysBeam}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysIncoming}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysOutgoing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarBeamProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarElementProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
To let raypyng analyze the results set:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{analyze} \PYG{o}{=} \PYG{k+kc}{False} \PYG{c+c1}{\PYGZsh{} don\PYGZsq{}t let RAY\PYGZhy{}UI analyze the results}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{raypyng\PYGZus{}analysis}\PYG{o}{=}\PYG{k+kc}{True} \PYG{c+c1}{\PYGZsh{} let raypyng analyze the results}
\end{sphinxVerbatim}

\sphinxAtStartPar
In this case only these exports are possible

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{sim}\PYG{o}{.}\PYG{n}{possible\PYGZus{}exports\PYGZus{}without\PYGZus{}analysis}\PYG{p}{)}
\PYG{o}{\PYGZgt{}} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysIncoming}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysOutgoing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
The exports are available for each optical element in the beamline, ImagePlanes included, and can be set like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} This must be a list of dictionaries}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{exports}  \PYG{o}{=}  \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{p}{:}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarElementProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{DetectorAtFocus}\PYG{p}{:}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarBeamProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
                \PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
Finally the simulations can be run using

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{multiprocessing}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{force}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
where the \sphinxtitleref{multiprocessing} parameter can be set either to False or to an int, corresponding to the number of parallel instances of RAY\sphinxhyphen{}UI to be used. Generally speaking the number of instances of RAY\sphinxhyphen{}UI must be lower than the number of cores available. If simulation using many rays, monitor the RAM usage of your computer. If the computation uses all the possible RAM of the computer the program may get blocked or not execute correctly.


\section{Exports}
\label{\detokenize{tutorial:exports}}

\subsection{Analysis perfomed by RAY\sphinxhyphen{}UI}
\label{\detokenize{tutorial:analysis-perfomed-by-ray-ui}}
\sphinxAtStartPar
If you decided to let RAY\sphinxhyphen{}UI doing the analysis, you should expect the following files to be
saved in your simulation folder:
\begin{itemize}
\item {} 
\sphinxAtStartPar
one file for each parameter you set with the values that you passed to the program.
If for instance you input the Dipole numberRays, you will find a file called
\sphinxtitleref{input\_param\_Dipole\_numberRays.dat}

\item {} 
\sphinxAtStartPar
one folder called \sphinxtitleref{round\_n} for each repetition of the simulations.
For instance if you set \sphinxcode{\sphinxupquote{sim.repeat=2}} you will have two folders \sphinxtitleref{round\_0} and \sphinxtitleref{round\_1}

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find the beamline files modified
with the parameters you set in \sphinxtitleref{sim.params}, these are the \sphinxtitleref{.rml} files,
that can be opened by RAY\sphinxhyphen{}UI.

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find your exported files, one for
each simulation. If for instance you exported the \sphinxtitleref{ScalarElementProperties} of the Dipole,
you will have a list of files \sphinxtitleref{0\_Dipole\sphinxhyphen{}ScalarElementProperties.csv}

\end{itemize}


\subsection{Analysis perfomed by raypyng}
\label{\detokenize{tutorial:analysis-perfomed-by-raypyng}}
\sphinxAtStartPar
If you decided to let raypyng doing the analysis, you should expect the following files to
be saved in your simulation folder:
\begin{itemize}
\item {} 
\sphinxAtStartPar
one file for each parameter you set with the values that you passed to the program.
If for instance you input the Dipole numberRays, you will find a file called
\sphinxtitleref{input\_param\_Dipole\_numberRays.dat}

\item {} 
\sphinxAtStartPar
one folder called \sphinxtitleref{round\_n} for each repetition of the simulations.
For instance if you set \sphinxcode{\sphinxupquote{sim.repeat=2}} you will have two folders \sphinxtitleref{round\_0} and \sphinxtitleref{round\_1}

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find the beamline files modified with the parameters
you set in \sphinxtitleref{sim.params}, these are the \sphinxtitleref{.rml} files, that can be opened by RAY\sphinxhyphen{}UI.

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find your exported files, one for each simulation.
If for instance you exported the \sphinxtitleref{RawRaysOutgoing} of the Dipole, you will
have a list of files \sphinxtitleref{0\_Dipole\sphinxhyphen{}RawRaysOutgoing.csv}

\item {} 
\sphinxAtStartPar
for each \sphinxtitleref{RawRaysOutgoing} file, raypyng calculates some properties,
and saves a corresponding file, for instance \sphinxtitleref{0\_Dipole\_analyzed\_rays.dat}. Each of these files contains the followin informations:
\begin{itemize}
\item {} 
\sphinxAtStartPar
SourcePhotonFlux

\item {} 
\sphinxAtStartPar
NumberRaysSurvived

\item {} 
\sphinxAtStartPar
PercentageRaysSurvived

\item {} 
\sphinxAtStartPar
PhotonFlux

\item {} 
\sphinxAtStartPar
Bandwidth

\item {} 
\sphinxAtStartPar
HorizontalFocusFWHM

\item {} 
\sphinxAtStartPar
VerticalFocusFWHM

\end{itemize}

\item {} 
\sphinxAtStartPar
In the simulation folder, all the for each exported element
is united (and in case of more rounds of simulations averaged) in one single file. For the dipole the fill is called \sphinxtitleref{Dipole.dat}

\end{itemize}


\subsection{Recipees}
\label{\detokenize{tutorial:recipees}}
\sphinxAtStartPar
Documentation still not available, see the examples.


\subsection{List of examples avalable and short explanation}
\label{\detokenize{tutorial:list-of-examples-avalable-and-short-explanation}}
\sphinxAtStartPar
In the example folder, the following examples are available:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{example\_simulation\_analyze.py} simulate a beamline,
let Ray\sphinxhyphen{}UI do the analysis

\item {} 
\sphinxAtStartPar
\sphinxtitleref{example\_simulation\_noanalyze.py} simulate a beamline,
let Ray\sphinxhyphen{}UI do the analysis

\item {} 
\sphinxAtStartPar
\sphinxtitleref{example\_eval\_noanalyze\_and\_analyze.py} plot the results
of the two previous simulations

\item {} 
\sphinxAtStartPar
\sphinxtitleref{example\_simulation\_Flux.py} simulations using the flux recipee,
useful if you intent is to simulate the flux of your beamline

\item {} 
\sphinxAtStartPar
\sphinxtitleref{example\_simulation\_RP.py} simulations using the resolving power
(RP) recipee, useful if you intent is to simulate the RP of your beamline.
The reflectivity of every optical element is switched to 100\% and not
calculated using the substrate and coiating(s) material(s). The
information about the Flux of the beamline are therefore not reliable.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{example\_beamwaist.py}: raypyng is able to plot the beamwaist of
the x\sphinxhyphen{}rays across your beamline. It performs simulations using the beamwaist recipee,
and it exports the raw raysoutgoing from each optical element. It then uses a
simple geometrical x\sphinxhyphen{}ray tracer to propagate each ray until the next optical
element, and plots the results (both top view and side view). This is still
experimental and it may fail.

\end{itemize}

\sphinxstepscope


\chapter{Simulation}
\label{\detokenize{simulate:simulation}}\label{\detokenize{simulate::doc}}\index{Simulate (class in raypyng.simulate)@\spxentry{Simulate}\spxextra{class in raypyng.simulate}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.simulate.}}\sphinxbfcode{\sphinxupquote{Simulate}}}{\emph{\DUrole{n}{rml}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{hide}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
A class that takes care of performing the simulations with RAY\sphinxhyphen{}UI
\index{\_\_init\_\_() (raypyng.simulate.Simulate method)@\spxentry{\_\_init\_\_()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.__init__}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_init\_\_}}}{\emph{\DUrole{n}{rml}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{hide}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{{ $\rightarrow$ None}}
\pysigstopsignatures
\sphinxAtStartPar
Initialize the class with a rml file
:param rml: string pointing to an rml file with the beamline template, or an RMLFile class object. Defaults to None.
:type rml: RMLFile/string, optional
:param hide: force hiding of GUI leftovers, xvfb needs to be installed. Defaults to False.
:type hide: bool, optional
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If the rml file is not defined an exception is raised

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_weakref\_\_ (raypyng.simulate.Simulate attribute)@\spxentry{\_\_weakref\_\_}\spxextra{raypyng.simulate.Simulate attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.__weakref__}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{\_\_weakref\_\_}}}
\pysigstopsignatures
\sphinxAtStartPar
list of weak references to the object (if defined)

\end{fulllineitems}

\index{analyze (raypyng.simulate.Simulate property)@\spxentry{analyze}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.analyze}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{analyze}}}
\pysigstopsignatures
\sphinxAtStartPar
Turn on or off the RAY\sphinxhyphen{}UI analysis of the results.
The analysis of the results takes time, so turn it on only if needed
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
True: analysis on, False: analysis off

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{exports (raypyng.simulate.Simulate property)@\spxentry{exports}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.exports}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{exports}}}
\pysigstopsignatures
\sphinxAtStartPar
The files to export once the simulation is complete.
for a list of possible files check self.possible\_exports
and self.possible\_exports\_without\_analysis.

\sphinxAtStartPar
It is expeceted a list of dictionaries, and for each dictionary the key is the element
to be exported and the valuee are the files to be exported

\end{fulllineitems}

\index{params (raypyng.simulate.Simulate property)@\spxentry{params}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.params}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{params}}}
\pysigstopsignatures
\sphinxAtStartPar
The parameters to scan, as a list of dictionaries.
For each dictionary the keys are the parameters elements of the beamline, and the values are the
values to be assigned.

\end{fulllineitems}

\index{path (raypyng.simulate.Simulate property)@\spxentry{path}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.path}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{path}}}
\pysigstopsignatures
\sphinxAtStartPar
The path where to execute the simlations
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
by default the path is the current path from which
the program is executed

\sphinxlineitem{Return type}
\sphinxAtStartPar
string

\end{description}\end{quote}

\end{fulllineitems}

\index{possible\_exports (raypyng.simulate.Simulate property)@\spxentry{possible\_exports}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.possible_exports}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{possible\_exports}}}
\pysigstopsignatures
\sphinxAtStartPar
A list of the files that can be exported by RAY\sphinxhyphen{}UI
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
list of the names of the possible exports for RAY\sphinxhyphen{}UI

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{possible\_exports\_without\_analysis (raypyng.simulate.Simulate property)@\spxentry{possible\_exports\_without\_analysis}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.possible_exports_without_analysis}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{possible\_exports\_without\_analysis}}}
\pysigstopsignatures
\sphinxAtStartPar
A list of the files that can be exported by RAY\sphinxhyphen{}UI when the
analysis option is turned off
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
list of the names of the possible exports for RAY\sphinxhyphen{}UI when analysis is off

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{raypyng\_analysis (raypyng.simulate.Simulate property)@\spxentry{raypyng\_analysis}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.raypyng_analysis}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{raypyng\_analysis}}}
\pysigstopsignatures
\sphinxAtStartPar
Turn on or off the RAYPyNG analysis of the results.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
True: analysis on, False: analysis off

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{repeat (raypyng.simulate.Simulate property)@\spxentry{repeat}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.repeat}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{repeat}}}
\pysigstopsignatures
\sphinxAtStartPar
The simulations can be repeated an arbitrary number of times
If the statitcs are not good enough using 2 millions of rays is suggested
to repeat them instead of increasing the number of rays
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
the number of repetition of the simulations, by default is 1

\sphinxlineitem{Return type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{rml (raypyng.simulate.Simulate property)@\spxentry{rml}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.rml}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{rml}}}
\pysigstopsignatures
\sphinxAtStartPar
RMLFile object instantiated in init

\end{fulllineitems}

\index{rml\_list() (raypyng.simulate.Simulate method)@\spxentry{rml\_list()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.rml_list}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{rml\_list}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
This function creates the folder structure and the rml files to simulate.
It requires the param to be set. Useful if one wants to create the simulation files
for a manual check before starting the simulations.

\end{fulllineitems}

\index{run() (raypyng.simulate.Simulate method)@\spxentry{run()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.run}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{run}}}{\emph{\DUrole{n}{recipe}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{/}}, \emph{\DUrole{n}{multiprocessing}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{force}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
This method starts the simulations. params and exports need to be defined.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{recipe}} (\sphinxstyleliteralemphasis{\sphinxupquote{SimulationRecipe}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If using a recipee pass it as a parameter. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{multiprocessing}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolint}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True all the cpus are used. If an integer n is provided, n cpus are used. Defaults to True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True all the simlations are performed, even if the export files already exist. If False only the simlations for which are missing some exports are performed. Defaults to False.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{save\_parameters\_to\_file() (raypyng.simulate.Simulate method)@\spxentry{save\_parameters\_to\_file()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.save_parameters_to_file}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{save\_parameters\_to\_file}}}{\emph{\DUrole{n}{dir}}}{}
\pysigstopsignatures
\sphinxAtStartPar
save all the user input parameters to file. It takes the values
from the SimulationParams class
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the folder where to save the parameters

\end{description}\end{quote}

\end{fulllineitems}

\index{simulation\_name (raypyng.simulate.Simulate property)@\spxentry{simulation\_name}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.Simulate.simulation_name}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{simulation\_name}}}
\pysigstopsignatures
\sphinxAtStartPar
A string to append to the folder where the simulations will be executed.

\end{fulllineitems}


\end{fulllineitems}

\index{SimulationParams (class in raypyng.simulate)@\spxentry{SimulationParams}\spxextra{class in raypyng.simulate}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.simulate.}}\sphinxbfcode{\sphinxupquote{SimulationParams}}}{\emph{\DUrole{n}{rml}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{param\_list}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
A class that takes care of the simulations parameters, makes sure that they are written correctly,
and returns the the list of simulations that is requested by the user.
\index{\_\_init\_\_() (raypyng.simulate.SimulationParams method)@\spxentry{\_\_init\_\_()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams.__init__}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_init\_\_}}}{\emph{\DUrole{n}{rml}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{param\_list}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{{ $\rightarrow$ None}}
\pysigstopsignatures
\sphinxAtStartPar
\_summary\_
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml}} (\sphinxstyleliteralemphasis{\sphinxupquote{RMLFile/string}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} string pointing to an rml file with the beamline template, or an RMLFile class object. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_list}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} list of dictionaries containing the parameters and values to simulate. Defaults to None.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_weakref\_\_ (raypyng.simulate.SimulationParams attribute)@\spxentry{\_\_weakref\_\_}\spxextra{raypyng.simulate.SimulationParams attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams.__weakref__}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{\_\_weakref\_\_}}}
\pysigstopsignatures
\sphinxAtStartPar
list of weak references to the object (if defined)

\end{fulllineitems}

\index{\_calc\_loop() (raypyng.simulate.SimulationParams method)@\spxentry{\_calc\_loop()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams._calc_loop}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_calc\_loop}}}{\emph{\DUrole{n}{verbose}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{bool}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{True}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the simulations loop
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
idependent and dependent parameters
self.simulations\_param\_list (list): parameters values for each simulation loop

\sphinxlineitem{Return type}
\sphinxAtStartPar
self.param\_to\_simulate (list)

\end{description}\end{quote}

\end{fulllineitems}

\index{\_check\_if\_enabled() (raypyng.simulate.SimulationParams method)@\spxentry{\_check\_if\_enabled()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams._check_if_enabled}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_check\_if\_enabled}}}{\emph{\DUrole{n}{param}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Check if a parameter is enabled
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param}} (\sphinxstyleliteralemphasis{\sphinxupquote{RML object}}) \textendash{} an parameter to simulate

\sphinxlineitem{Returns}
\sphinxAtStartPar
True if the parameter is enabled, False otherwise

\sphinxlineitem{Return type}
\sphinxAtStartPar
(bool)

\end{description}\end{quote}

\end{fulllineitems}

\index{\_check\_param() (raypyng.simulate.SimulationParams method)@\spxentry{\_check\_param()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams._check_param}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_check\_param}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Check that self.param is a list of dictionaries, and convert the
items of the dictionaries to lists, otherwise raise an exception.

\end{fulllineitems}

\index{\_enable\_param() (raypyng.simulate.SimulationParams method)@\spxentry{\_enable\_param()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams._enable_param}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_enable\_param}}}{\emph{\DUrole{n}{param}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Set enabled to True in a beamline object, and auto to False
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param}} (\sphinxstyleliteralemphasis{\sphinxupquote{RML object}}) \textendash{} beamline object

\end{description}\end{quote}

\end{fulllineitems}

\index{\_extract\_param() (raypyng.simulate.SimulationParams method)@\spxentry{\_extract\_param()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams._extract_param}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_extract\_param}}}{\emph{\DUrole{n}{verbose}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{bool}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Parse self.param and extract dependent and independent parameters
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True print the returned objects. Defaults to False.

\sphinxlineitem{Returns}
\sphinxAtStartPar
indieendent parameter values
self.ind\_par (list): independent parameters
self.dep\_param\_dependency (dict): dictionary of dependencies
self.dep\_value\_dependency (list): dictionaries of dependent values
self.dep\_par (list): dependent parameters

\sphinxlineitem{Return type}
\sphinxAtStartPar
self.ind\_param\_values (list)

\end{description}\end{quote}

\end{fulllineitems}

\index{\_write\_value\_to\_param() (raypyng.simulate.SimulationParams method)@\spxentry{\_write\_value\_to\_param()}\spxextra{raypyng.simulate.SimulationParams method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams._write_value_to_param}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_write\_value\_to\_param}}}{\emph{\DUrole{n}{param}}, \emph{\DUrole{n}{value}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Write a value to a parameter, making sure enable is T
and auto is F
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param}} (\sphinxstyleliteralemphasis{\sphinxupquote{RML object}}) \textendash{} beamline object

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} the value to set the beamline object to

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{params (raypyng.simulate.SimulationParams property)@\spxentry{params}\spxextra{raypyng.simulate.SimulationParams property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams.params}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{params}}}
\pysigstopsignatures
\sphinxAtStartPar
The parameters to scan, as a list of dictionaries.
For each dictionary the keys are the parameters elements of the beamline, and the values are the
values to be assigned.

\end{fulllineitems}

\index{rml (raypyng.simulate.SimulationParams property)@\spxentry{rml}\spxextra{raypyng.simulate.SimulationParams property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.simulate.SimulationParams.rml}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{rml}}}
\pysigstopsignatures
\sphinxAtStartPar
RMLFile object instantiated in init

\end{fulllineitems}


\end{fulllineitems}



\chapter{RayUIRunner}
\label{\detokenize{simulate:rayuirunner}}\index{RayUIRunner (class in raypyng.runner)@\spxentry{RayUIRunner}\spxextra{class in raypyng.runner}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.runner.}}\sphinxbfcode{\sphinxupquote{RayUIRunner}}}{\emph{\DUrole{n}{ray\_path}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{ray\_binary}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}rayui.sh\textquotesingle{}}}, \emph{\DUrole{n}{background}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{hide}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
RayUIRunner class implements all logic to start a RayUI process
\index{\_\_detect\_ray\_path() (raypyng.runner.RayUIRunner method)@\spxentry{\_\_detect\_ray\_path()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.__detect_ray_path}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_detect\_ray\_path}}}{}{{ $\rightarrow$ str}}
\pysigstopsignatures
\sphinxAtStartPar
Internal function to autodetect installation path of RayUI
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{RayPyRunnerError}} \textendash{} is case no ray installations can be detected

\sphinxlineitem{Returns}
\sphinxAtStartPar
string with the detected ray installation path

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (raypyng.runner.RayUIRunner method)@\spxentry{\_\_init\_\_()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.__init__}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_init\_\_}}}{\emph{\DUrole{n}{ray\_path}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{ray\_binary}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}rayui.sh\textquotesingle{}}}, \emph{\DUrole{n}{background}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{hide}\DUrole{o}{=}\DUrole{default_value}{False}}}{{ $\rightarrow$ None}}
\pysigstopsignatures
\end{fulllineitems}

\index{\_\_weakref\_\_ (raypyng.runner.RayUIRunner attribute)@\spxentry{\_\_weakref\_\_}\spxextra{raypyng.runner.RayUIRunner attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.__weakref__}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{\_\_weakref\_\_}}}
\pysigstopsignatures
\sphinxAtStartPar
list of weak references to the object (if defined)

\end{fulllineitems}

\index{\_readline() (raypyng.runner.RayUIRunner method)@\spxentry{\_readline()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner._readline}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_readline}}}{}{{ $\rightarrow$ str}}
\pysigstopsignatures
\sphinxAtStartPar
read a line from the stdout of the process and convert to a string
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
line read from the input

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{\_write() (raypyng.runner.RayUIRunner method)@\spxentry{\_write()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner._write}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_write}}}{\emph{\DUrole{n}{instr}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{endline}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\textbackslash{}n\textquotesingle{}}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Write command to RayUI interface
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{instr}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} \_description\_

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{endline}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} \_description\_. Defaults to endline character.

\end{itemize}

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{RayPyRunnerError}} \textendash{} \_description\_

\end{description}\end{quote}

\end{fulllineitems}

\index{isrunning (raypyng.runner.RayUIRunner property)@\spxentry{isrunning}\spxextra{raypyng.runner.RayUIRunner property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.isrunning}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{isrunning}}}
\pysigstopsignatures
\sphinxAtStartPar
Check weather a process is running and rerutn a boolean
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
returns True if the process is running, otherwise False

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{kill() (raypyng.runner.RayUIRunner method)@\spxentry{kill()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.kill}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{kill}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
kill a RAY\sphinxhyphen{}UI process

\end{fulllineitems}

\index{pid (raypyng.runner.RayUIRunner property)@\spxentry{pid}\spxextra{raypyng.runner.RayUIRunner property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.pid}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{pid}}}
\pysigstopsignatures
\sphinxAtStartPar
Get process id of the RayUI process
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
PID of the process if it running, None otherwise

\sphinxlineitem{Return type}
\sphinxAtStartPar
\_type\_

\end{description}\end{quote}

\end{fulllineitems}

\index{run() (raypyng.runner.RayUIRunner method)@\spxentry{run()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.runner.RayUIRunner.run}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{run}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Open one instance of RAY\sphinxhyphen{}UI using subprocess
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{RayPyRunnerError}} \textendash{} if the RAY\sphinxhyphen{}UI executable is not found raise an error

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\chapter{PostProcessing}
\label{\detokenize{simulate:postprocessing}}\index{PostProcess (class in raypyng.postprocessing)@\spxentry{PostProcess}\spxextra{class in raypyng.postprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.postprocessing.}}\sphinxbfcode{\sphinxupquote{PostProcess}}}
\pysigstopsignatures
\sphinxAtStartPar
class to post\sphinxhyphen{}process the data.
At the moment works only if the exported data are RawRaysOutgoing
\index{\_\_init\_\_() (raypyng.postprocessing.PostProcess method)@\spxentry{\_\_init\_\_()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess.__init__}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_init\_\_}}}{}{{ $\rightarrow$ None}}
\pysigstopsignatures
\end{fulllineitems}

\index{\_\_weakref\_\_ (raypyng.postprocessing.PostProcess attribute)@\spxentry{\_\_weakref\_\_}\spxextra{raypyng.postprocessing.PostProcess attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess.__weakref__}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{\_\_weakref\_\_}}}
\pysigstopsignatures
\sphinxAtStartPar
list of weak references to the object (if defined)

\end{fulllineitems}

\index{\_extract\_bandwidth\_fwhm() (raypyng.postprocessing.PostProcess method)@\spxentry{\_extract\_bandwidth\_fwhm()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess._extract_bandwidth_fwhm}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_extract\_bandwidth\_fwhm}}}{\emph{\DUrole{n}{rays\_bw}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{array}}}{}
\pysigstopsignatures
\sphinxAtStartPar
calculate the fwhm of the rays\_bw.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{(}}\sphinxstyleliteralstrong{\sphinxupquote{np}} (\sphinxstyleliteralemphasis{\sphinxupquote{rays\_bw}}) \textendash{} array): the energy of the x\sphinxhyphen{}rays

\sphinxlineitem{Returns}
\sphinxAtStartPar
fwhm

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{\_extract\_focus\_fwhm() (raypyng.postprocessing.PostProcess method)@\spxentry{\_extract\_focus\_fwhm()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess._extract_focus_fwhm}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_extract\_focus\_fwhm}}}{\emph{\DUrole{n}{rays\_pos}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{array}}}{}
\pysigstopsignatures
\sphinxAtStartPar
calculate the fwhm of rays\_pos
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rays\_pos}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} contains positions of the x\sphinxhyphen{}rays

\sphinxlineitem{Returns}
\sphinxAtStartPar
fwhm

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{\_extract\_intensity() (raypyng.postprocessing.PostProcess method)@\spxentry{\_extract\_intensity()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess._extract_intensity}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_extract\_intensity}}}{\emph{\DUrole{n}{rays}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{array}}}{}
\pysigstopsignatures
\sphinxAtStartPar
calculate how many rays there are
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rays}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} contains rays information

\end{description}\end{quote}

\end{fulllineitems}

\index{\_list\_files() (raypyng.postprocessing.PostProcess method)@\spxentry{\_list\_files()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess._list_files}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_list\_files}}}{\emph{\DUrole{n}{dir\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{end\_filename}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}}{}
\pysigstopsignatures
\sphinxAtStartPar
List all the files in dir\_path ending with end\_filename
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} path to a folder

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{end\_filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the listed files end with end\_filename

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
list of files in dir\_path ending eith end\_filename

\sphinxlineitem{Return type}
\sphinxAtStartPar
res (list)

\end{description}\end{quote}

\end{fulllineitems}

\index{\_load\_file() (raypyng.postprocessing.PostProcess method)@\spxentry{\_load\_file()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess._load_file}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_load\_file}}}{\emph{\DUrole{n}{filepath}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Load a .npy file and returns the array
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{filepath}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the path to the file to load

\sphinxlineitem{Returns}
\sphinxAtStartPar
The loaded numpy array

\sphinxlineitem{Return type}
\sphinxAtStartPar
arr (np.array)

\end{description}\end{quote}

\end{fulllineitems}

\index{\_save\_file() (raypyng.postprocessing.PostProcess method)@\spxentry{\_save\_file()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess._save_file}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_save\_file}}}{\emph{\DUrole{n}{filename}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{array}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{array}}, \emph{\DUrole{n}{header}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
This function is used to save files,
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} file name(path)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{array}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} array to save

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{header}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} header for the file

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{cleanup() (raypyng.postprocessing.PostProcess method)@\spxentry{cleanup()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess.cleanup}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{cleanup}}}{\emph{\DUrole{n}{dir\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{repeat}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{int}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{1}}, \emph{\DUrole{n}{exp\_elements}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}list\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
This functions reads all the temporary files created by self.postptocess\_RawRays()
saves one file for each exported element in dir\_path, and deletes the temporary files.
If more than one round of simulations was done, the values are averaged.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The path to the folder to cleanup. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{repeat}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of rounds of simulations. Defaults to 1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{exp\_elements}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the exported elements names as str. Defaults to None.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{extract\_nrays\_from\_source() (raypyng.postprocessing.PostProcess method)@\spxentry{extract\_nrays\_from\_source()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess.extract_nrays_from_source}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{extract\_nrays\_from\_source}}}{\emph{\DUrole{n}{rml\_filename}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Extract photon flux from rml file, find source automatically
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml\_filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the rml file to use to extract the photon flux

\sphinxlineitem{Returns}
\sphinxAtStartPar
the photon flux

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{postprocess\_RawRays() (raypyng.postprocessing.PostProcess method)@\spxentry{postprocess\_RawRays()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulate:raypyng.postprocessing.PostProcess.postprocess_RawRays}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{postprocess\_RawRays}}}{\emph{\DUrole{n}{exported\_element}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{exported\_object}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{dir\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{sim\_number}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{rml\_filename}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
The method looks in the folder dir\_path for a file with the filename:
filename = os.path.join(dir\_path,sim\_number+exported\_element + ‘\sphinxhyphen{}’ + exported\_object+’.csv’)
for each file it calculates the number of rays, the bandwidth, and the horizontal and vertical focus size,
it saves it in an array that is composed by {[}n\_rays,bandwidth,hor\_focus,vert\_focus{]}, that is then saved to
os.path.join(dir\_path, sim\_number+exported\_element+’\_analyzed\_rays.npy’)
:param exported\_element: a list of containing the exported elements name as str. Defaults to None.
:type exported\_element: list, optional
:param exported\_object: the exported opbject, tested only with RawRaysOutgoing. Defaults to None.
:type exported\_object: str, optional
:param dir\_path: the folder where the file to process is located. Defaults to None.
:type dir\_path: str, optional
:param sim\_number: the prefix of the file, that is the simulation number with a \_prepended, ie “{\color{red}\bfseries{}0\_}”. Defaults to None.
:type sim\_number: str, optional

\end{fulllineitems}


\end{fulllineitems}




\renewcommand{\indexname}{Index}
\printindex
\end{document}